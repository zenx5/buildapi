(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[22],{1199:function(e,t,n){"use strict";n.r(t),n.d(t,"statusName",(function(){return z}));var r=n(20),a=n(19),c=n(13),i=n(11),s=n.n(i),o=n(937),u=n(569),l=n(178),d=n(532),f=n(563),b=n(557),j=n(0),p=n(670),v=n(225),h=n(15),m=n(1201),O=n(1196),x=n(1202),g=n(1203),k=n(1204),w=n(1181),y=n(1163),S=n(1178),T=n(1179),_=n(1205),C=n(545),I=n(1206),q=n(179),W=n(753),D=n(223),E=n(96),R=n(35),L=n(1),A=function(e){var t=e.open,n=void 0!==t&&t,r=e.onClose,i=e.form,o=e.afterSubmit,u=Object(R.a)().user,f=Object(W.a)(),b=f.form,v=b.control,A=b.handleSubmit,B=b.setValue,F=f.resetForm,U=Object(D.a)(),N=U.startLoading,P=U.endLoading,V=U.isLoading,z=Object(E.a)(),J=z.showErrorToast,M=z.showSuccessToast,H=Object(j.useState)([]),Q=Object(c.a)(H,2),X=Q[0],Y=Q[1];Object(j.useEffect)((function(){n||(F(),Y([]))}),[n]),Object(j.useEffect)((function(){if(i){var e=function(){var e=Object(a.a)(s.a.mark((function e(){var t,n,r,a,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(),e.prev=1,e.next=4,Promise.all([p.a.getTicketInfo(i.id),p.a.getTicketConversation(i.id)]);case 4:t=e.sent,n=Object(c.a)(t,2),r=n[0],a=n[1],Y(a),o=r.description_text,u=r.subject,B("description",o),B("subject",u),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),J(e.t0);case 17:P();case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(){return e.apply(this,arguments)}}();e()}else F(),Y([])}),[i]);var Z=function(){var e=Object(a.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(),e.prev=1,e.next=4,p.a.createTicket(Object(h.a)(Object(h.a)({},t),{},{email:u.freshdesk_email,type:"Question",custom_fields:{cf_client_name:"".concat(u.first_name," ").concat(u.last_name),cf_store_name:null===u||void 0===u||null===(n=u.store_default)||void 0===n?void 0:n.name}}));case 4:r=e.sent,M("Ticket sended!"),null===o||void 0===o||o(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),J(e.t0);case 12:P();case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(L.jsxs)(S.a,{fullWidth:!0,maxWidth:"lg",open:n,children:[Object(L.jsx)(T.a,{children:"Ticket"}),Object(L.jsxs)(_.a,{children:[Object(L.jsxs)(d.a,{spacing:2,mt:2,children:[!i&&Object(L.jsx)(q.a,{name:"name",control:v,render:function(e){var t=e.field,n=e.fieldState.error;return Object(L.jsx)(C.a,Object(h.a)({fullWidth:!0,label:"*Name",error:!!n,helperText:null===n||void 0===n?void 0:n.message},t))}}),Object(L.jsx)(q.a,{name:"subject",control:v,render:function(e){var t=e.field,n=e.fieldState.error;return Object(L.jsx)(C.a,Object(h.a)({fullWidth:!0,disabled:Boolean(i),label:"*Subject",error:!!n,helperText:null===n||void 0===n?void 0:n.message},t))}}),Object(L.jsx)(q.a,{name:"description",control:v,render:function(e){var t=e.field,n=e.fieldState.error;return Object(L.jsx)(C.a,Object(h.a)({fullWidth:!0,label:"*Description",disabled:Boolean(i),multiline:!0,rows:6,error:!!n,helperText:null===n||void 0===n?void 0:n.message},t))}})]}),X.length>0&&Object(L.jsx)(m.a,{position:"right",children:X.map((function(e,t){var n,r;return Object(L.jsxs)(O.a,{position:"right",sx:{"&:before":{content:"none"}},children:[Object(L.jsxs)(x.a,{children:[Object(L.jsx)(g.a,{color:"primary"}),Object(L.jsx)(k.a,{})]}),Object(L.jsxs)(w.a,{children:[Object(L.jsxs)(l.a,{variant:"subtitle2",component:"span",children:[(null===e||void 0===e?void 0:e.support_email)||""," ("," ".concat(null===e||void 0===e||null===(n=e.created_at)||void 0===n||null===(r=n.split("T"))||void 0===r?void 0:r[0]," "),")"]}),Object(L.jsx)(l.a,{children:(null===e||void 0===e?void 0:e.body_text)||""})]})]})}))})]}),Object(L.jsxs)(I.a,{children:[Object(L.jsx)(y.a,{loading:V,onClick:r,children:"cancel"}),!i&&Object(L.jsx)(y.a,{loading:V,variant:"contained",onClick:A(Z),children:"send"})]})]})},B=n(601),F=n(593),U=n(606),N=n.n(U),P=n(212),V=n.n(P),z={2:"Open",3:"Pending",4:"Resolved",5:"Closed",6:"Waiting on Customer",7:"Waiting on Third Party"},J=function(e){switch(e){case 4:case 5:return"success";default:return"warning"}},M=[{id:"subject",label:"Subject",value:"subject",alignRight:!1},{id:"status",label:"Status",value:function(e){var t=e.status;return Object(L.jsx)(o.a,{sx:{color:"#fff"},label:z[t],color:J(t)})},alignRight:!1},{id:"created_at",label:"Send Date",value:function(e){var t,n=e.created_at;return null===n||void 0===n||null===(t=n.split("T"))||void 0===t?void 0:t[0]},alignRight:!1},{id:"options",label:"Actions",align:"center",options:[{icon:N.a,text:"View details",onClick:function(e,t){return{el:e,action:t}},color:"green",action:"view"}]}];t.default=function(){var e=Object(R.a)().user,t=Object(B.a)(),n=t.data,i=t.selectedItem,o=t.setData,h=t.selectedIndex,m=t.handleCloseSelectedItem,O=t.handleSelectedItem,x=t.handleUpdateItem,g=Object(F.a)(),k=g.isOpenDialog,w=g.openDialog,y=g.closeDialog,S=Object(D.a)(),T=S.startLoading,_=S.endLoading,C=S.isLoading,I=Object(E.a)().showErrorToast,q=Object(j.useState)(!1),W=Object(c.a)(q,2),U=W[0],N=W[1];Object(j.useEffect)((function(){if(null!==e&&void 0!==e&&e.freshdesk_email){var t=function(){var t=Object(a.a)(s.a.mark((function t(){var n,r,a,c,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return T(),t.prev=1,t.next=4,p.a.getTicketByEmail(null===e||void 0===e?void 0:e.freshdesk_email);case 4:n=t.sent,o(n),N(!0),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),"email"===(null===t.t0||void 0===t.t0||null===(r=t.t0.response)||void 0===r||null===(a=r.data)||void 0===a||null===(c=a.errors)||void 0===c||null===(i=c[0])||void 0===i?void 0:i.field)?I("Email is not registered in Freshdesk"):I(t.t0);case 12:_();case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();t()}}),[e]);var P=function(){y(),m()};return null!==e&&void 0!==e&&e.freshdesk_email?Object(L.jsxs)(u.a,{maxWidth:"lg",children:[Object(L.jsxs)(d.a,{direction:{xs:"column",sm:"row"},flexWrap:"nowrap",justifyContent:"space-between",children:[Object(L.jsx)(l.a,{variant:"h2",mb:2,children:"Tickets"}),U&&Object(L.jsx)(f.a,{title:"Create ticket",children:Object(L.jsx)(b.a,{variant:"contained",onClick:w,sx:{mr:{xs:0,sm:3},mb:{xs:2,sm:2,md:0},borderRadius:10,minWidth:40,py:1,height:"fit-content",bgcolor:"#E47911"},children:Object(L.jsx)(V.a,{})})})]}),Object(L.jsx)(v.a,{header:M,data:n,isLoading:C,handleMoreAction:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if("view"===e)O(t),w()}}),Object(L.jsx)(A,{open:k,onClose:P,form:i,afterSubmit:function(e){h>-1?x(e):o((function(t){return[].concat(Object(r.a)(t),[e])})),P()}})]}):Object(L.jsx)(u.a,{maxWidth:"lg",children:Object(L.jsx)(l.a,{variant:"h5",mb:2,textAlign:"center",children:'You need to update your profile, update "Freshdesk email" field to send tickets'})})}},593:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(13),a=n(0);function c(){var e=Object(a.useState)(!1),t=Object(r.a)(e,2),n=t[0],c=t[1];return{isOpenDialog:n,openDialog:function(){return c(!0)},closeDialog:function(){return c(!1)}}}},601:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20),a=n(13),c=n(0);function i(){var e=Object(c.useState)([]),t=Object(a.a)(e,2),n=t[0],i=t[1],s=Object(c.useState)(null),o=Object(a.a)(s,2),u=o[0],l=o[1],d=Object(c.useState)(-1),f=Object(a.a)(d,2),b=f[0],j=f[1],p=function(){l(null),j(-1)};return{data:n,setData:i,selectedItem:u,selectedIndex:b,handleSelectedItem:function(e){var t=n.indexOf(e);t>-1&&(j(t),l(e))},handleCloseSelectedItem:p,handleUpdateItem:function(e){var t=b,a=Object(r.a)(n);a.splice(t,1,e),i(a),p()},handleRemoveItem:function(){var e=b,t=Object(r.a)(n);t.splice(e,1),i(t),p()}}}},670:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(19),a=n(11),c=n.n(a),i=n(141),s=n.n(i).a.create({baseURL:"https://automationempire.freshdesk.com/api/v2/tickets/",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("iaeop6p6moF6vCcZ3v:X")}}),o={createTicket:function(){var e=Object(r.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.post("",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAllTickets:function(){var e=Object(r.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.get("?include=requester");case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getTicketByEmail:function(){var e=Object(r.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.get("?email=".concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getTicketInfo:function(){var e=Object(r.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.get("/".concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getTicketConversation:function(){var e=Object(r.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.get("/".concat(t,"/conversations"));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sendReply:function(){var e=Object(r.a)(c.a.mark((function e(t,n){var r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.post("/".concat(t,"/reply"),{body:u(n)});case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},u=function(e){return'<div style="font-family:-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, sans-serif; font-size:14px">\n<div dir="ltr">'.concat(e,'\n</div>\n<div dir="ltr"><div><br></div></div>\n</div>')}},753:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(179),a=n(599),c=n(600),i=Object(a.e)({name:Object(a.g)().required("required"),subject:Object(a.g)().required("required"),description:Object(a.g)().required("required"),status:Object(a.d)().required("required"),priority:Object(a.d)().required("required")}),s={name:"",subject:"",description:"",status:2,priority:1};function o(){var e=Object(r.f)({resolver:Object(c.a)(i),defaultValues:s});return{form:e,resetForm:function(){return e.reset(s)}}}}}]);
//# sourceMappingURL=22.7bc2417a.chunk.js.map